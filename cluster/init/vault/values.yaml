---
vault:
  global:
    resources:
      requests:
        memory: '256Mi'
        cpu: '250m'
      limits:
        memory: '512Mi'
        cpu: '1000m'

  service:
    enabled: false

  server:
    image:
      repository: "hashicorp/vault"
      tag: "1.10.3"

    readinessProbe:
      enabled: true
      path: "/v1/sys/health?standbyok=true&sealedcode=204&uninitcode=204"

    livenessProbe:
      enabled: false

    extraVolumes:
      - type: secret
        name: kms-creds
        load: false

    standalone:
      config: |
        listener "tcp" {
          tls_disable = 1
          address = "[::]:8200"
          cluster_address = "[::]:8201"
        }
        storage "file" {
          path = "/vault/data"
        }
        seal "gcpckms" {
          credentials = "/vault/userconfig/kms-creds/credentials.json"
          project     = "omdv-homelab"
          region      = "global"
          key_ring    = "vault-keyring"
          crypto_key  = "vault-key"
        }
