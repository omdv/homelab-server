---
- name: -- HOST SETUP --
  hosts: server
  roles:
    - manage-host
  vars:
    - user: om
    - wanted_ip: 192.168.0.24
    - zfs_cache: /dev/nvme0n1p2
    - zfs_log: /dev/nvme0n1p3
    - zfs_pool: pool
    - docker_machine: remote
    - psql_db_user: test
    - psql_db_name: test
    - psql_db_password: test
    - database_location: /pool/database
    - backup_pool: /pool/backup
    - backup_repos:
      - dir: repo-derp
        user: om
        pass: "{{ lookup('env','BORG_PASSPHRASE') }}"
      - dir: repo-server
        user: root
        pass: "{{ lookup('env','HOMELAB_BORG_PASSPHRASE') }}"
    - backup_b2_bucket: om-backup
  become: yes

- name: -- DOCKER SETUP--
  hosts: server
  roles:
    - manage-docker
  vars:
    - pool: /pool
    - config_volume: /pool/config
    - data_volume: /pool/databases
    - media_volume: /pool/media
    - book_volume: /pool/books
    - user: om

- name: -- LXD SETUP--
  hosts: server
  tags:
    - lxd
  roles:
    - manage-lxd

- hosts: pihole
  tags:
    - pihole
    - lxd
  roles:
    - stevenharradine.pihole