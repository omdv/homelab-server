---
- name: create persistent dir for hassio
  file:
    path: "{{ config_volume }}/hassio"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"
  become: true

- name: start hassio container
  docker_container:
    name: hassio
    state: started
    network_mode: host
    restart_policy: always
    labels:
      traefik.enable: "false"
      launchpanel.enabled: "yes"
      launchpanel.ip: "{{ hostvars[inventory_hostname]['ansible_default_ipv4']['address'] }}"
      launchpanel.name: "hassio"
      launchpanel.port: "8123"
    image: homeassistant/home-assistant:stable
    volumes:
      - "{{ config_volume }}/hassio:/config"
